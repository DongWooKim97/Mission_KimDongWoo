# 2Week_김동우.md

## Title: [2Week] 김동우

### 미션 요구사항 분석 & 체크리스트

---

### N주차 미션 요약

1. 한명의 인스타회원이 다른 인스타회원에게 중복으로 호감표시를 할 수 없습니다.
2. 한명의 인스타회원이 11명 이상의 호감상대를 등록 할 수 없습니다.
3. 중복으로 호감표시하는 상황이 발생했을 때 기존의 사유와 다른 사유로 호감을 표시하는 경우에는 성공으로 처리한다.

- [x] 1번 케이스
    - [x] 먼저 입력한 인스타유저가 호감표시가 되어있는지 확인
    - [x] 확인 후, 등록여부에 따라
        - [x] 등록 O -> 처리하면 안됨 (rq.historyBack)
        - [x] 등록 X -> 새로운 등록
    - [x] 등록여부 확인 -> checkDuplicateAttractiveTypeCode()메서드 활용
        - [x] 로그인한 유저의 인스타아이디를 이용해 리스트를 뽑아내고, 이 리스트에서 addForm에서 입력받은 username과 attractiveTypeCode와 일치한 경우를 찾음.


- [x] 2번 케이스
    - [x] 10명까지 호감상대 등록이 가능하고, 11명부터는 호감표시 불가.
        - [x] NotProd를 통해 임시방편 데이터를 생성하고, user12가 user1~10을 호감했지만 user11은 호감표시 못하는 상황 연출
    - [x] 11명 이상부터 등록할 때 rq.historyBack으로 처리

- [ ] 3번 케이스
    - [x] ex) 기존이 호감 : `외모`, 새로운 호감 `성격` 일 경우 새로운 호감등록이 아닌 사유만 수정되는 형식
        - [x] 로그인한 유저의 인스타 정보의 아이디와 로그인한 사람이 입력한 사람의 인스타 정보 아이디를 이용하여 엔티티객체를 받아옴
            - [x] `LikeablePersonRepostiory`
              의 `LikeablePerson findByFromInstaMemberIdAndToInstaMemberId(Long fromInstaMemberId, Long toInstaMemberId);`
        - [x] 이러한 엔티티객체의 id값을 추출하여 새롭게 save하는 작업을 진행
            - [x] `LikeablePersonService`의 `update` 메서드
            - [x] `LikeablePersonService`의 `like` 메서드 처럼 Transactional 어노테이션 추가 및 수정을 위한 Modifying 추가
        - [x] 새로운 엔티티를 작성해서 위로 덮어버리는 작업을 채택. 그렇게 하기 위해 기존의 `like`와 다르게 `.id(updatePersonId)` 를 추가하여 해당 칼럼을 직접 지정 후 저장.
    - [ ] 호감표시 변경 시 resultCode=S-2, msg=`who`에 대한 호감사유를 외모에서 성격으로 변경합니다.
        - [ ] 구현 실패..! 리팩토링때 진행 요망

**[특이사항]**

[소감]

사실 1주차 미션을 수행할 때는 코드의 전반적인 이해가 부족했다고 생각합니다. 그렇기에 리팩토링에 시간을 투자하여 이해가 안됐던 부분들을 해결하고자 노력하였고, 어느정도 성공했다고 생각합니다. 2주차를 시작하고
미션을 받았을 때는 리팩토링의 효과덕분인지 생각보다 쉽게 읽혔고, 머리속에 해야할 것들이 정리되었습니다.

그러나 2주차 미션을 본격적으로 시작하고 나서는이 생각이 완전히 바뀌었습니다. '여전히 코드에 대한 이해가 부족하다' 미션을 끝내는 현재까지 느끼게 됐습니다. 또한 기능 구현 성공에만 몰두하다 보니 코드 정리,
리팩토링 할 시간을 더더욱이 부족했습니다.

그래도 1주차 때보다는 생각보다 재밌었고, 수월했다 생각합니다. 그 이유는 리팩토링이라고 생각하구요. 강사님의 코드를 보지않고 다시한번 리팩토링을 거치고, 강사님의 코드와 비교해봄으로써 다시 한번 코드의 깊은 이해를
가져가려고 합니다.

--------
[어려운점]

구현하면서 가장 어려웠던거는 역시 관계였습니다. 관계에 대해 어떻게 정의하고, 어떤 식으로 활용할지가 가장 어려웠습니다. 저는 특히 예외케이스4번을 이름과 호감표시 둘 다 중복된걸로 착각하고 구현하여 예외케이스
6번에 돌입했을땐 쉽다 생각했지만 4번을 다시 돌아가서 이름만 중복인 상태와 이름 및 호감표시 둘 다 중복인걸로 나눴어야 했기 때문이죠. 관계를 조금 더 이해하고 진행했다면 이러한 문제도 쉽게 풀었으리라 생각하지만
그 부분에 대해서 이해가 부족했다고 생각합니다. 다시 한번 공부해보겠습니다.

또한 수정해야한다고 했을땐 정말 막막했습니다. CRUD의 U인것은 알았지만 그 이후에 전혀 생각나지 않았기 때문입니다. JpaRepository에 update메서드를 처음엔 무작정 작성하고 사용해보려 했지만,
상속관계를 타고타고 들어가면서 확인해봤더니 update 메서드가 없는 것 같았습니다. '그래서 어떻게해야하지? delete하고 다시 save해야하나? 싶었지만, 그렇게 되면 연결 관계는 어떻게 되는거지? '라는
고민에서 가장 많은 시간을 쓴 것 같습니다. 그렇게 구글링을 통해 찾아온 방법이 Modifying 어노테이션을 붙이는 것인데, 정확한 이해와 동작 원리를 이해하지 못한채 사용했습니다. 이 부분도 다시
공부해보겠습니다.

